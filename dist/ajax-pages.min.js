function ajaxPages(e){function t(t){if(t===window.location.href)return!1;r.beforeLoading(),$(r.loaderSelector).fadeIn();var n=new Date;$.get(t,function(l){var c=new Date,f=c.getTime()-n.getTime(),s=r.minLoadTime;s=f>=r.minLoadTime?0:r.minLoadTime-f,setTimeout(function(){if("replace"===r.replaceMethod){var n="<div>"+l.replace(/^[\s\S]*<body.*?>|<\/body>[\s\S]*$/gi,"")+"</div>",c=$(n);c=c.find(r.searchSelector).html(),$(r.replaceSelector).html(c)}else"append"===r.replaceMethod&&$(r.replaceSelector).append(l);if($(r.loaderSelector).fadeOut(),r.changeTitle){var f="";if(r.titleSelector==a){var s=l.indexOf(o)+o.length,d=l.indexOf(i);f=l.substring(s,d)}else f=c.find(r.titleSelector).text();document.title=f}if(r.enableUrlChange&&window.history.pushState({html:c,pageTitle:document.title,isFromAjaxPages:!0},"",t),r.scrollTop&&$("html, body").animate({scrollTop:$(r.scrollTopSelector).offset().top},r.scrollTopDuration),focusedInput){var p=$('input[name="'+focusedInput+'"]');if(1===p.length){p[0].focus();var u=p.val();p.val("").val(u)}focusedInput=null}r.enableAnalyticsTrack&&"function"==typeof ga&&ga("send","pageview",t),r.afterLoading(),ajaxPages(e)},s)}).fail(function(){r.onError(),$(r.loaderSelector).fadeOut()})}function n(e,t){var n=new RegExp("([?&])"+e+"=.*?(&|#|$)");return t.replace(n,"$1")}var a="title",o="<title>",i="</title>",l={rootSelector:"body",replaceSelector:"#content",replaceMethod:"replace",searchSelector:"#content",loaderSelector:"#loadingContent",linkSelector:"a[data-link='ajax']",formSelector:"form[data-link='ajax']",paginationKey:"p",scrollTop:!0,scrollTopSelector:"#content",scrollTopDuration:500,enableAnalyticsTrack:!0,enableUrlChange:!0,changeTitle:!0,titleSelector:"title",minLoadTime:0,typingTimeout:500,beforeLoading:function(){},afterLoading:function(){},onError:function(){}},r=jQuery.extend(l,e);return window.history.replaceState({html:$(r.searchSelector).html(),pageTitle:document.title,isFromAjaxPages:!0},"",window.location.href),$(r.loaderSelector).hide(),window.onpopstate=function(t){console.log(t.state),t.state&&t.state.isFromAjaxPages&&($(r.replaceSelector).html(t.state.html),document.title=t.state.pageTitle,r.enableAnalyticsTrack&&"function"==typeof ga&&ga("send","pageview",window.location.href),ajaxPages(e))},$("html").find(r.rootSelector).each(function(e,a){var o=jQuery(a),i=o.find(r.linkSelector).get(),l=o.find(r.formSelector).get();$.each(i,function(e,n){$(n).attr("onclick","return false"),$(n).click(function(e){t($(e.target).attr("href"))})}),$.each(l,function(e,a){$(a).attr("submit","return false");var o=window.location.href,i="?";-1!==o.indexOf("?")&&(i="&"),$(a).find("input[type='text'], select").each(function(){$(this).on("input change",function(){isTyping&&clearTimeout(isTyping);var e=$(this).attr("name"),a=$(this).val(),l=0;focusedInput=e,$(this).is("input[type='text']")&&(l=r.typingTimeout),isTyping=setTimeout(function(){if(o=n(r.paginationKey,o),""===a)o=n(e,o);else if(-1!==o.indexOf(e)){var l=new RegExp("("+e+"=)[^&]+");o=o.replace(l,"$1"+a)}else o=o+i+e+"="+a;o=o.replace("&&","&"),o=o.replace("?&","?"),o=o.replace(/([?&])$/,""),t(o)},l)})})})})}var isTyping=!1,focusedInput=null;